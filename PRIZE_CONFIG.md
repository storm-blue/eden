# 🎯 前后端奖品配置同步说明

## 📋 配置对应关系

### **关键原则**
⚠️ **前后端奖品数组的顺序必须完全一致！**

### **工作机制**
1. 后端根据概率选中奖品，返回奖品在数组中的**索引**
2. 前端根据后端返回的**索引**，在转盘上定位到对应的奖品格子
3. 转盘停止在对应格子，显示中奖结果

### **当前配置**

| 索引 | 前端显示 | 后端配置 | 概率 | 说明 |
|------|----------|----------|------|------|
| 0 | 🍰 吃的～ | 🍰 吃的～ | 25% | 普通奖品 |
| 1 | 🥤 喝的～ | 🥤 喝的～ | 25% | 普通奖品 |
| 2 | ❤️ 爱 | ❤️ 爱 | 1% | 传说奖品 |
| 3 | 💸 空空如也 | 💸 空空如也 | 20% | 普通奖品 |
| 4 | 🧧 红包 | 🧧 红包 | 4% | 稀有奖品 |
| 5 | 🔄 再转一次 | 🔄 再转一次 | 25% | 特殊奖品 |
| 6 | 🎁 随机礼物 | 🎁 随机礼物 | 0% | 装饰奖品 |

## 🔧 修改配置步骤

### **1. 修改概率**
只需修改后端 `LotteryService.STATIC_PRIZES` 中的概率值：

```java
private static final List<Prize> STATIC_PRIZES = Arrays.asList(
    new Prize("🍰 吃的～", 0.25, "普通"),      // 修改这里的概率
    // ... 其他奖品
);
```

### **2. 添加新奖品**
⚠️ **必须同时修改前后端**

**后端修改：**
```java
// 在 STATIC_PRIZES 末尾添加
new Prize("🎉 新奖品", 0.05, "稀有")
```

**前端修改：**
```javascript
// 在 prizes 数组对应位置添加
{
    background: '#颜色代码',
    fonts: [{
        text: '🎉',
        top: '15%',
        fontSize: '30px'
    }, {
        text: '新奖品',
        top: '55%',
        fontSize: '16px',
        fontColor: '#333',
        fontWeight: 'bold'
    }]
}
```

### **3. 删除奖品**
⚠️ **必须同时从前后端删除，保持索引一致**

### **4. 调整顺序**
⚠️ **必须同时调整前后端顺序，保持索引对应**

## 🧪 验证配置

### **运行验证脚本**
```bash
bash verify-prize-config.sh
```

### **测试抽奖**
```bash
bash test-static-prizes.sh
```

### **手动验证**
1. 启动前后端服务
2. 进行多次抽奖
3. 确认中奖结果显示正确
4. 检查转盘停止位置与中奖结果一致

## ⚠️ 常见错误

### **错误1：顺序不一致**
- **现象**：抽中A奖品，转盘显示B奖品
- **原因**：前后端数组顺序不同
- **解决**：调整数组顺序保持一致

### **错误2：概率总和不为1**
- **现象**：某些奖品永远不会中奖
- **原因**：概率总和超过1.0或小于1.0
- **解决**：调整概率确保总和为1.0

### **错误3：数组长度不同**
- **现象**：某些情况下抽奖失败
- **原因**：前后端奖品数量不同
- **解决**：确保数组长度一致

## 📝 维护建议

1. **版本控制**：概率配置修改要记录在git提交中
2. **测试验证**：每次修改后都要测试验证
3. **文档更新**：修改配置后更新此文档
4. **备份配置**：重要配置修改前先备份

## 🎯 最佳实践

1. **集中管理**：所有概率配置集中在后端代码中
2. **配置验证**：启动时验证概率总和为1.0
3. **日志记录**：记录每次抽奖的详细信息
4. **监控统计**：定期检查实际中奖比例是否符合预期
