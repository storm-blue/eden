/* ğŸ”¥ æ˜Ÿæ˜ŸåŸCPUå ç”¨ä¼˜åŒ–CSS - ç§»åŠ¨ç«¯çœç”µæ¨¡å¼ */

/* ===== 1. ç§»åŠ¨ç«¯ç¦ç”¨CPUå¯†é›†å‹åŠ¨ç”»ï¼ˆç«‹å³é™ä½40-50% CPUï¼‰===== */
@media screen and (max-width: 768px) {
    
    /* ğŸ”¥ ç¦ç”¨è£…é¥°åŠ¨ç”»ï¼ˆæœ€è€—CPUçš„åŠ¨ç”»ï¼‰ */
    .decorations::before,
    .decorations::after {
        display: none !important;
    }
    
    /* ğŸ”¥ ç®€åŒ–å»ºç­‘ç‰©åŠ¨ç”» */
    .building {
        animation-duration: 2s !important; /* ä»4så‡å°‘åˆ°2s */
        filter: none !important; /* ç§»é™¤drop-shadow */
        text-shadow: 0 0 5px rgba(255, 255, 255, 0.3) !important; /* ç®€åŒ–é˜´å½± */
    }
    
    /* ğŸ”¥ ç®€åŒ–æ˜Ÿæ˜ŸåŠ¨ç”» */
    .city-star {
        animation-duration: 2s !important; /* ä»3så‡å°‘åˆ°2s */
        filter: none !important;
    }
    
    /* ğŸ”¥ ç¦ç”¨æ‚¬åœæ•ˆæœï¼ˆç§»åŠ¨ç«¯ä¸éœ€è¦ï¼‰ */
    .city-star:hover,
    .building:hover {
        transform: none !important;
        filter: none !important;
    }
    
    /* ğŸ”¥ ç®€åŒ–æ ‡é¢˜åŠ¨ç”» */
    .star-city-title h2 {
        animation: none !important; /* å®Œå…¨ç¦ç”¨æ ‡é¢˜åŠ¨ç”» */
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.4) !important;
    }
    
    /* ğŸ”¥ ç®€åŒ–èƒŒæ™¯ */
    .star-city-background {
        background: #667eea !important; /* çº¯è‰²èƒŒæ™¯ï¼Œç§»é™¤æ¸å˜ */
        background-image: none !important;
    }
    
    /* ğŸ”¥ ç®€åŒ–å…³é—­æŒ‰é’® */
    .star-city-close-button {
        backdrop-filter: none !important;
        background: rgba(255, 255, 255, 0.3) !important;
        transition: none !important;
    }
    
    .star-city-close-button:hover {
        transform: none !important;
    }
}

/* ===== 2. çœç”µæ¨¡å¼ä¸“ç”¨æ ·å¼ ===== */
.power-save-mode {
    /* ğŸ”¥ å…¨å±€ç¦ç”¨åŠ¨ç”» */
    *, *::before, *::after {
        animation-duration: 0s !important;
        animation-delay: 0s !important;
        transition-duration: 0s !important;
    }
    
    /* ğŸ”¥ ç§»é™¤æ‰€æœ‰æ»¤é•œå’Œé˜´å½± */
    * {
        filter: none !important;
        text-shadow: none !important;
        box-shadow: none !important;
    }
    
    /* ğŸ”¥ ç®€åŒ–èƒŒæ™¯ */
    .star-city-container {
        background: #667eea !important;
        background-image: none !important;
    }
}

/* ===== 3. ä¼˜åŒ–åŠ¨ç”»æ€§èƒ½ï¼ˆå¯ç”¨GPUåŠ é€Ÿï¼‰===== */

/* ğŸ”¥ ä¸ºæ‰€æœ‰åŠ¨ç”»å…ƒç´ å¯ç”¨GPUåŠ é€Ÿ */
.building,
.city-star,
.background-star,
.heart-effect {
    will-change: transform;
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px;
}

/* ğŸ”¥ ä¼˜åŒ–çˆ±å¿ƒåŠ¨ç”»ï¼Œå‡å°‘å¤æ‚åº¦ */
@keyframes heartFloat {
    0%, 100% {
        transform: translateY(0) translateZ(0) scale(1);
    }
    50% {
        transform: translateY(-8px) translateZ(0) scale(1.05); /* å‡å°‘ç§»åŠ¨è·ç¦»å’Œç¼©æ”¾ */
    }
}

/* ğŸ”¥ ç®€åŒ–å»ºç­‘ç‰©æµ®åŠ¨åŠ¨ç”» */
@keyframes buildingFloat {
    0%, 100% {
        transform: translateY(0) translateZ(0);
    }
    50% {
        transform: translateY(-5px) translateZ(0); /* å‡å°‘ç§»åŠ¨è·ç¦» */
    }
}

/* ğŸ”¥ ç®€åŒ–æ˜Ÿæ˜Ÿé—ªçƒåŠ¨ç”» */
@keyframes cityStarTwinkle {
    0%, 100% {
        opacity: 0.8;
        transform: scale(1) translateZ(0);
    }
    50% {
        opacity: 1;
        transform: scale(1.1) translateZ(0); /* å‡å°‘ç¼©æ”¾å¹…åº¦ */
    }
}

/* ===== 4. ç§»åŠ¨ç«¯å¼ºåˆ¶æ¨ªå±ä¼˜åŒ– ===== */
@media screen and (max-width: 768px) {
    .star-city-container.force-landscape {
        /* ğŸ”¥ ä½¿ç”¨3Då˜æ¢å¯ç”¨GPUåŠ é€Ÿ */
        transform: translate3d(-50%, -50%, 0) rotate(90deg) !important;
        backface-visibility: hidden !important;
        perspective: 1000px !important;
        
        /* ğŸ”¥ å‡å°‘é‡ç»˜ */
        contain: layout style paint !important;
    }
}

/* ===== 5. ä¼˜åŒ–æ¨¡æ€æ¡†æ€§èƒ½ ===== */
.residence-modal-overlay,
.residence-modal-content {
    will-change: transform, opacity;
    transform: translateZ(0);
    backface-visibility: hidden;
    
    /* ğŸ”¥ å‡å°‘é‡æ’ */
    contain: layout style;
}

/* ===== 6. ä½ç«¯è®¾å¤‡ä¸“ç”¨ä¼˜åŒ– ===== */
@media screen and (max-width: 768px) and (max-device-pixel-ratio: 2) {
    /* ğŸ”¥ ä½åƒç´ å¯†åº¦è®¾å¤‡è¿›ä¸€æ­¥ä¼˜åŒ– */
    
    /* å®Œå…¨ç¦ç”¨å¤æ‚åŠ¨ç”» */
    @keyframes heartFloat,
    @keyframes buildingFloat,
    @keyframes cityStarTwinkle {
        0%, 100% {
            transform: translateZ(0);
        }
    }
    
    /* é™ä½åŠ¨ç”»å¸§ç‡ */
    .building,
    .city-star {
        animation-timing-function: steps(10) !important; /* é™ä½åˆ°10å¸§ */
    }
    
    /* ç®€åŒ–å­—ä½“æ¸²æŸ“ */
    * {
        text-rendering: optimizeSpeed !important;
        -webkit-font-smoothing: none !important;
        -moz-osx-font-smoothing: unset !important;
    }
}

/* ===== 7. å‡å°‘CSSè®¡ç®—å¤æ‚åº¦ ===== */

/* ğŸ”¥ é¿å…å¤æ‚çš„é€‰æ‹©å™¨ */
.star-city-container .building {
    /* ä½¿ç”¨ç®€å•é€‰æ‹©å™¨æ›¿ä»£å¤æ‚åµŒå¥— */
}

/* ğŸ”¥ å‡å°‘box-shadowå±‚æ•° */
.explosion-1,
.explosion-2,
.explosion-3,
.explosion-4,
.explosion-5 {
    /* ç§»åŠ¨ç«¯ç®€åŒ–çˆ†ç‚¸æ•ˆæœ */
}

@media screen and (max-width: 768px) {
    .explosion-1,
    .explosion-2,
    .explosion-3,
    .explosion-4,
    .explosion-5 {
        box-shadow: 0 0 0 10px currentColor !important; /* ç®€åŒ–ä¸ºå•å±‚é˜´å½± */
    }
}

/* ===== 8. å†…å­˜ä¼˜åŒ– ===== */
@media screen and (max-width: 768px) {
    
    /* ğŸ”¥ å‡å°‘å±‚å ä¸Šä¸‹æ–‡ */
    .star-city-container {
        contain: layout style paint;
        isolation: isolate;
    }
    
    /* ğŸ”¥ ä¼˜åŒ–æ»šåŠ¨æ€§èƒ½ */
    .residence-event-scroll {
        -webkit-overflow-scrolling: touch;
        transform: translateZ(0);
        will-change: scroll-position;
        contain: layout style paint;
    }
    
    /* ğŸ”¥ å‡å°‘é‡ç»˜åŒºåŸŸ */
    .heart-effect,
    .background-star {
        contain: layout style paint;
    }
}

/* ===== 9. åŠ¨æ€ç¦ç”¨åŠ¨ç”»çš„å·¥å…·ç±» ===== */

/* ğŸ”¥ JavaScriptå¯ä»¥åŠ¨æ€æ·»åŠ è¿™ä¸ªç±»æ¥ç¦ç”¨åŠ¨ç”» */
.disable-animations {
    *, *::before, *::after {
        animation-duration: 0s !important;
        animation-delay: 0s !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0s !important;
        transition-delay: 0s !important;
    }
}

/* ğŸ”¥ ä½æ€§èƒ½æ¨¡å¼ */
.low-performance-mode {
    /* ç¦ç”¨æ‰€æœ‰ç‰¹æ•ˆ */
    filter: none !important;
    backdrop-filter: none !important;
    text-shadow: none !important;
    box-shadow: none !important;
    
    /* ç®€åŒ–èƒŒæ™¯ */
    background-image: none !important;
    
    /* ç¦ç”¨å˜æ¢ */
    transform: none !important;
}

/* ===== 10. å¸§ç‡æ§åˆ¶ ===== */

/* ğŸ”¥ 30fpsæ¨¡å¼ï¼ˆé€šè¿‡stepså®ç°ï¼‰ */
.fps-30 .building {
    animation-timing-function: steps(30, end) !important;
}

.fps-30 .city-star {
    animation-timing-function: steps(30, end) !important;
}

.fps-30 .heart-effect {
    animation-timing-function: steps(30, end) !important;
}

/* ğŸ”¥ 15fpsçœç”µæ¨¡å¼ */
.fps-15 .building,
.fps-15 .city-star,
.fps-15 .heart-effect {
    animation-timing-function: steps(15, end) !important;
}

/* ===== 11. å“åº”å¼æ€§èƒ½ä¼˜åŒ– ===== */

/* ğŸ”¥ æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´æ€§èƒ½ */
@media screen and (max-width: 480px) {
    /* è¶…å°å±å¹•è®¾å¤‡æ›´æ¿€è¿›çš„ä¼˜åŒ– */
    .star-city-container * {
        animation: none !important;
        transition: none !important;
        filter: none !important;
        text-shadow: none !important;
        box-shadow: none !important;
    }
}

@media screen and (min-width: 1200px) {
    /* å¤§å±è®¾å¤‡å¯ä»¥ä½¿ç”¨æ›´å¤šç‰¹æ•ˆ */
    .star-city-container {
        /* æ¢å¤å®Œæ•´ç‰¹æ•ˆ */
    }
}
